## Recon Module "Scanner"
## By ShowNadda

# Version 1.0
# Global Imports
import time
import sys
from scapy.all import Ether, ARP, srp, conf

def scan_arp(iface, ip_range):
    print("[!] Now scanning IP range: ", ip_range)
    local_time = time.time()
    print("[+] Scan started at: ", time.ctime(local_time))
    conf.verb = 0
    broadcast = "ff:ff:ff:ff:ff:ff"
    layer_ether = Ether(dst=broadcast)
    layer_arp = ARP(pdst=ip_range)
    packet = layer_ether/layer_arp
    ans, unans =srp(packet, iface=iface, timeout=2, inter=0.1)
    for snd, rcv in ans:
        ip = rcv[ARP].psrc
        mac = rcv[Ether].src
        print(ip, mac)
    duration = time.time() - local_time
    print("[+] Network Scan Complete!!! Duration: ", duration)

# Example command;
# scanner_01.py eth0 192.196.0.1/24
if __name__ == "__main__":
    iface = sys.argv[1]
    ip_range = sys.argv[2]
    scan_arp(iface, ip_range)