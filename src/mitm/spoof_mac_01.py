## Spoof Mac ID
## By ShowNadda
## v 1.0

# Global Imports
import subprocess
import re

class change_mac:
    def __init__(self):
        self.mac = ""

    def get_mac(self, iface):
        output = subprocess.run(["ifconfig", iface], shell=False,capture_output=True)
        cmd_result = output.stdout.decode('utf-8')
        pattern = r'ether\s[\da-z]{2}:[\da-z]{2}:[\da-z]{2}:[\da-z]{2}:[\da-z]{2}:[\da-z]{2}'
        regex = re.compile(pattern)
        result = regex.search(cmd_result)
        current_mac = result.group().split(" ")[1]
        self.mac = current_mac
        return current_mac

    def change_mac(self, iface, new_mac):
        print("[!] Current MAC Address is ",self.get_mac(iface))
        output = subprocess.run(["ifconfig", iface, "down"], shell= False, capture_output=True)
        print(output.stderr.decode('utf-8'))
        output = subprocess.run(["ifconfig", iface, "hw","ether", new_mac], shell= False, capture_output=True)
        print(output.stderr.decode('utf-8'))
        output = subprocess.run(["ifconfig", iface, "up"], shell= False, capture_output=True)
        print(output.stderr.decode('utf-8'))
        print("[!] MAC Address has been updated to ", self.get_mac)
        return self.get_mac(iface)